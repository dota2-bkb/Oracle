# Dota 2 战队数据分析系统使用手册

欢迎使用 Dota 2 战队数据分析系统。本手册旨在帮助您（领队/教练）快速上手本系统，无需任何代码基础即可完成数据的录入、查询与报告生成。

---

## 目录

1.  [快速上手 SOP (标准操作流程)](#1-快速上手-sop-标准操作流程)
2.  [功能页面详解](#2-功能页面详解)
    *   [数据录入](#21-数据录入)
    *   [比赛列表](#22-比赛列表)
    *   [统计分析 (核心功能)](#23-统计分析-核心功能)
    *   [选手管理](#24-选手管理)
    *   [版本管理](#25-版本管理)
    *   [专家模式](#26-专家模式)
    *   [系统设置](#27-系统设置)

---

## 1. 快速上手 SOP (标准操作流程)

### 场景一：日常比赛数据归档
**目标**：将刚打完的比赛存入系统。

1.  **准备数据**：获取比赛编号 (Match ID)。
2.  **进入系统**：点击左侧导航栏的 **"数据录入"**。
3.  **自动录入**：
    *   在 "比赛编号" 输入框中粘贴 ID。
    *   点击 **"从 OpenDota 抓取"**。
    *   系统会自动拉取 BP、胜负、选手等信息。
    *   **确认数据**：重点检查队伍名称是否正确，如果不正确（如路人局或队名显示错误），请手动修正 "我方队伍名称" 和 "对手队伍名称"。
    *   点击 **"💾 保存比赛数据"**。

### 场景二：赛前分析对手
**目标**：即将对阵某战队（例如 `XG`），需要一份分析报告。

1.  **进入系统**：点击左侧导航栏的 **"统计分析"**。
2.  **筛选对手**：
    *   在左侧 "目标战队" 下拉框中选择 `XG`。
    *   (可选) 在 "时间范围模式" 中选择 "按版本" 或 "按日期" 来过滤最近的比赛。
    *   (可选) 筛选特定 "联赛"。
3.  **查看概况**：
    *   在 **"🛡️ 战队概况"** 标签页，查看其总胜率、天辉/夜魇胜率。
    *   查看 **"本队常用英雄 (Pick)"** 了解他们最喜欢抢什么。
    *   查看 **"对手禁用英雄 (Ban)"** 了解别人打他们最喜欢 Ban 什么。
    *   使用 **"英雄深度分析"**，选择他们的招牌英雄，查看 "最佳搭档" 和 "位置分布"。
4.  **查看绝活**：
    *   切换到 **"👤 选手绝活"** 标签页。
    *   逐个点击 "1号位" 到 "5号位"，查看每个选手的英雄池深度和高胜率英雄。
5.  **导出报告**：
    *   在左侧栏底部，选择 **"导出模版"** (推荐 "模版 3: 纯文字战报" 或 "模版 1: 详细战绩与BP")。
    *   点击 **"生成 Excel 报告"**。
    *   点击 **"📥 下载 Excel"**，将文件发送给教练组。

### 场景三：修正选手位置
**目标**：系统自动识别的位置不准（例如把 4 号位识别成了 5 号位）。

1.  **进入系统**：点击左侧导航栏的 **"选手管理"**。
2.  **绑定位置**：
    *   在 "手动绑定选手位置" 区域，选择战队和选手。
    *   在 "预设位置" 中选择正确的位置（1-5）。
    *   点击 **"绑定/更新"**。
3.  **批量修复**：
    *   点击页面上方的 **"🛠️ 将当前选手定位应用到历史比赛"** 按钮。
    *   系统会重新扫描历史比赛，强制将该选手修正为您刚才设定的位置。

---

## 2. 功能页面详解

### 2.1 数据录入
这是系统的数据源头。
*   **手动录入模式**：适用于 OpenDota 尚未更新或私密训练赛。需要手动填写每一个 Pick/Ban 和选手 ID。
*   **OpenDota API 抓取 (推荐)**：最常用的方式。只需输入比赛 ID，一键获取所有信息。
*   **Excel 批量导入**：适用于一次性导入大量历史数据。先点击 "下载模版"，填好后上传即可。

### 2.2 比赛列表
*   **功能**：查看数据库中已存储的所有比赛流水账。
*   **操作**：
    *   可以按战队、比赛 ID 或日期筛选。
    *   点击每场比赛的 **"删除"** 按钮可以移除错误数据。
    *   点击 **"展开"** 可以看到该场比赛的详细 BP 流程图。

### 2.3 统计分析 (核心功能)
这是教练组最常用的页面。
*   **筛选栏 (左侧)**：
    *   **目标战队**：必须选择，决定了分析的主角。
    *   **联赛筛选**：智能关联，选了战队后只会显示该战队参加过的联赛。
    *   **时间范围**：支持按游戏版本（如 7.35）或具体日期筛选。
*   **Excel 报告 (左侧)**：
    *   **模版 1**: 包含每场比赛的详细 BP 图（横向排列）和详细统计数据。
    *   **模版 2**: 仅包含 BP 网格图（纵向排列），适合打印或做战报长图。
    *   **模版 3**: 纯文字版战报，带有颜色高亮（黄色=首选/Ban，绿色=Counter），信息密度最高，适合快速复盘。
*   **内容标签页**：
    *   **战队概况**：宏观数据，胜率、高频英雄、英雄组合胜率。
    *   **选手绝活**：自动识别每个位置的主力选手，分析其英雄池、胜率及阵营偏好。
    *   **BP 链条**：可视化展示最近 10 场比赛的 BP 顺序，帮助发现 BP 规律。

### 2.4 选手管理
*   **选手列表**：查看系统中已记录的所有选手。
*   **位置绑定**：**关键功能**。Dota 2 的 API 经常分不清 4/5 号位或 1/2 号位。在这里手动指定某位选手的 "主打位置" (Default Pos)，系统在统计时就会以此为准，不再猜测。

### 2.5 版本管理
*   **功能**：维护 Dota 2 的游戏版本号（如 7.37, 7.36）。
*   **用途**：确保 "统计分析" 页面中的 "按版本筛选" 功能准确。通常在新版本发布时需要手动更新一次日期。

### 2.6 专家模式
*   **功能**：直接对数据库进行 SQL 查询。
*   **注意**：**仅限技术人员使用**。如果不了解 SQL 语言，请勿操作，以免损坏数据。

### 2.7 系统设置
*   **英雄数据更新**：如果游戏更新了新英雄，点击 "更新英雄列表" 即可。
*   **英雄别名 (Slang) 管理**：
    *   点击 "下载英雄数据 (CSV)"。
    *   在 Excel 中编辑 `slang` 列（例如将 "Ancient Apparition" 改为 "冰魂"）。
    *   上传 CSV 文件。
    *   **效果**：所有导出的 Excel 报告中，英雄名字都会变成您设置的简称，更符合阅读习惯。

---

**遇到问题？**
如果系统报错或显示异常，请截图报错信息（通常是红色的文字块）发送给技术支持人员。

